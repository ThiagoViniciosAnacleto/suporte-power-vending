<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Central de Suporte - Home</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header class="topbar">
        <div class="topbar-left">
            <h1>{{ titulo_pagina }}</h1>
        </div>
        <div class="topbar-right">
            <form action="/" method="get" class="topbar-form">
                <button type="submit">‚Üê Voltar</button>
            </form>
            <form action="/logout" method="get" class="topbar-form">
                <button type="submit">Sair</button>
            </form>
        </div>
    </header>


    <main class="home-main">
        <nav class="home-nav">
            <ul>
                <li><a href="/novo">‚ûï Criar Chamado</a></li>
                <li><a href="/listar">üìÇ Lista de Chamados</a></li>
                <li><a href="/dashboard">üìä Dashboard</a></li>
                <li><a href="/cadastrar_empresa">‚ûï Criar Empresa</a></li>
                <li><a href="/cadastrar_maquina">‚ûï Criar Tipo Maquina</a></li>
                <li><a href="/cadastrar_usuario">‚ûï Criar Novo Usuario</a></li>
                <li><a href="/gerenciar_usuarios">‚ûï Editar Privil√©gios</a></li>
            </ul>
        </nav>

<div class="cards-abertos-container" id="cards-abertos-container">
    {% if chamados_abertos %}
        {% for chamado in chamados_abertos %}
            <!-- Card Chamado -->
            <div class="chamado-card" onclick="abrirModalChamado({{ chamado.id }})" id="card-{{ chamado.id }}">
                <div class="chamado-card-header">
                    <span class="chamado-id">#{{ chamado.id }}</span>
                    <span class="chamado-status aberto">{{ chamado.status }}</span>
                </div>
                <div class="chamado-card-main">
                    <span><strong>Cliente:</strong> {{ chamado.cliente }}</span>
                    <span><strong>Empresa:</strong> {{ chamado.empresa }}</span>
                    <span><strong>Data:</strong> {{ chamado.data }}</span>
                </div>
            </div>
            <!-- Modal Chamado (um por chamado) -->
            <div class="modal-chamado" id="modal-chamado-{{ chamado.id }}" style="display: none;">
                <div class="modal-content">
                    <span class="close-modal" onclick="fecharModalChamado({{ chamado.id }})">&times;</span>
                    <h2>Chamado #{{ chamado.id }} - {{ chamado.status }}</h2>
                    <p><strong>Respons√°vel:</strong> {{ chamado.responsavel_atendimento }}</p>
                    <p><strong>Data:</strong> {{ chamado.data }} {{ chamado.horario }}</p>
                    <p><strong>Cliente:</strong> {{ chamado.cliente }}</p>
                    <p><strong>Empresa:</strong> {{ chamado.empresa }}</p>
                    <p><strong>Tipo de M√°quina:</strong> {{ chamado.tipo_maquina }}</p>
                    <p><strong>Porta SSH:</strong> {{ chamado.porta_ssh }}</p>
                    <p><strong>Prioridade:</strong> {{ chamado.prioridade }}</p>
                    <p><strong>Origem:</strong> {{ chamado.origem }}</p>
                    <p><strong>Tipo de a√ß√£o:</strong> {{ chamado.tipo_acao }}</p>
                    <p><strong>Respons√°vel pela a√ß√£o:</strong> {{ chamado.responsavel_acao }}</p>
                    <p><strong>Relato:</strong> {{ chamado.relato }}</p>
                    <p><strong>Descri√ß√£o da a√ß√£o:</strong> {{ chamado.descricao_acao }}</p>
                </div>
            </div>
        {% endfor %}
        <!-- Overlay global, fora do for -->
        <div class="modal-overlay" id="modal-overlay" style="display: none;"></div>
    {% else %}
        <p style="color:#fff;text-align:center;font-size:1.25rem;">Nenhum chamado aberto.</p>
    {% endif %}
</div>


        <section class="future-options">
            <h3>Futuras op√ß√µes:</h3>
            <ul>
                <li>‚öôÔ∏è Configura√ß√µes</li>
            </ul>
        </section>
    </main>

    {% with mensagens = get_flashed_messages() %}
        {% if mensagens %}
            <div class="toast" id="toast">
                {{ mensagens[0] }}
            </div>
        {% endif %}
    {% endwith %}

    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
</html>
